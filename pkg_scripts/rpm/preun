# Uninstall package - stop services
if [ $1 -eq 0 ]; then
    sensu_services="sensu-client sensu-server sensu-api sensu-dashboard"

    # Disable and stop sensu services
    for service in $sensu_services; do
        chkconfig $service off
        chkconfig --del $service
        if [ -f "/etc/init.d/$service" ]; then
            /etc/init.d/$service stop || true
        fi
    done

    # send sensu-runsvdir a hup to stop itself and supervised services
    if [ -f "/etc/init/sensu-runsvdir.conf" ]; then
        reload sensu-runsvdir || pkill -HUP -f /opt/sensu/embedded/bin/runsvdir || true
    fi
    if [ -f "/etc/inittab" ]; then
        if grep -q sensu-runsvdir /etc/inittab; then
            sed "/sensu-runsvdir/d" /etc/inittab > /etc/inittab
            init q
            pkill -HUP -f /opt/sensu/embedded/bin/runsvdir || true
        fi
    fi
fi
